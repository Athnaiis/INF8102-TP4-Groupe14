
Report Summary

┌────────────────────┬────────────────┬─────────────────┬─────────┬───────────────────┐
│       Target       │      Type      │ Vulnerabilities │ Secrets │ Misconfigurations │
├────────────────────┼────────────────┼─────────────────┼─────────┼───────────────────┤
│ Q3_3.json          │ cloudformation │        -        │    -    │        15         │
├────────────────────┼────────────────┼─────────────────┼─────────┼───────────────────┤
│ bucket_python.json │ cloudformation │        -        │    -    │         0         │
├────────────────────┼────────────────┼─────────────────┼─────────┼───────────────────┤
│ vpc-Q3_1.yaml      │ cloudformation │        -        │    -    │         4         │
├────────────────────┼────────────────┼─────────────────┼─────────┼───────────────────┤
│ vpc-Q3_2.yaml      │ cloudformation │        -        │    -    │        13         │
├────────────────────┼────────────────┼─────────────────┼─────────┼───────────────────┤
│ vpc_Q1.yaml        │ cloudformation │        -        │    -    │         5         │
└────────────────────┴────────────────┴─────────────────┴─────────┴───────────────────┘
Legend:
- '-': Not scanned
- '0': Clean (no security findings detected)


Q3_3.json (cloudformation)
==========================
Tests: 57 (SUCCESSES: 42, FAILURES: 15)
Failures: 15 (MEDIUM: 1, HIGH: 14, CRITICAL: 0)

AVD-AWS-0014 (MEDIUM): Trail is not enabled across all regions.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Activity could be happening in your account in a different region. When creating Cloudtrail in the AWS Management Console the trail is configured by default to be multi-region, this isn't the case with the Terraform resource. Cloudtrail should cover the full AWS account to ensure you can track changes in regions you are not actively operating in.


See https://avd.aquasec.com/misconfig/avd-aws-0014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:69-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  69 ┌   "Q3Trail": {
  70 │    "DependsOn": [
  71 │     "Q3BackupBucket",
  72 │     "Q3BackupBucketPolicy"
  73 │    ],
  74 │    "Properties": {
  75 │     "EventSelectors": [
  76 │      {
  77 └       "DataResources": [
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0015 (HIGH): CloudTrail does not use a customer managed key to encrypt the logs.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Using AWS managed keys does not allow for fine grained control.  Using Customer managed keys provides comprehensive control over cryptographic keys, enabling management of policies, permissions, and rotation, thus enhancing security and compliance measures for sensitive data and systems.


See https://avd.aquasec.com/misconfig/avd-aws-0015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:69-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  69 ┌   "Q3Trail": {
  70 │    "DependsOn": [
  71 │     "Q3BackupBucket",
  72 │     "Q3BackupBucketPolicy"
  73 │    ],
  74 │    "Properties": {
  75 │     "EventSelectors": [
  76 │      {
  77 └       "DataResources": [
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0016 (HIGH): Trail does not have log validation enabled.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Illicit activity could be removed from the logs. Log validation should be activated on Cloudtrail logs to prevent the tampering of the underlying data in the S3 bucket. It is feasible that a rogue actor compromising an AWS account might want to modify the log data to remove trace of their actions.


See https://avd.aquasec.com/misconfig/avd-aws-0016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:69-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  69 ┌   "Q3Trail": {
  70 │    "DependsOn": [
  71 │     "Q3BackupBucket",
  72 │     "Q3BackupBucketPolicy"
  73 │    ],
  74 │    "Properties": {
  75 │     "EventSelectors": [
  76 │      {
  77 └       "DataResources": [
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0086 (HIGH): No public access block so not blocking public acls
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.


See https://avd.aquasec.com/misconfig/avd-aws-0086
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:4-12
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 ┌   "Q3BackupBucket": {
   5 │    "Properties": {
   6 │     "BucketName": "polystudents-ing-groupe14-tp4-q3-backup",
   7 │     "VersioningConfiguration": {
   8 │      "Status": "Enabled"
   9 │     }
  10 │    },
  11 │    "Type": "AWS::S3::Bucket"
  12 └   },
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0086 (HIGH): No public access block so not blocking public acls
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.


See https://avd.aquasec.com/misconfig/avd-aws-0086
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:47-68
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  47 ┌   "Q3SourceBucket": {
  48 │    "Properties": {
  49 │     "BucketName": "polystudents-ing-groupe14-tp4-q3",
  50 │     "ReplicationConfiguration": {
  51 │      "Role": "arn:aws:iam::625730254292:role/LabRole",
  52 │      "Rules": [
  53 │       {
  54 │        "Destination": {
  55 └         "Bucket": "arn:aws:s3:::polystudents-ing-groupe14-tp4-q3-backup"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0087 (HIGH): No public access block so not blocking public policies
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.


See https://avd.aquasec.com/misconfig/avd-aws-0087
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:4-12
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 ┌   "Q3BackupBucket": {
   5 │    "Properties": {
   6 │     "BucketName": "polystudents-ing-groupe14-tp4-q3-backup",
   7 │     "VersioningConfiguration": {
   8 │      "Status": "Enabled"
   9 │     }
  10 │    },
  11 │    "Type": "AWS::S3::Bucket"
  12 └   },
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0087 (HIGH): No public access block so not blocking public policies
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.


See https://avd.aquasec.com/misconfig/avd-aws-0087
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:47-68
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  47 ┌   "Q3SourceBucket": {
  48 │    "Properties": {
  49 │     "BucketName": "polystudents-ing-groupe14-tp4-q3",
  50 │     "ReplicationConfiguration": {
  51 │      "Role": "arn:aws:iam::625730254292:role/LabRole",
  52 │      "Rules": [
  53 │       {
  54 │        "Destination": {
  55 └         "Bucket": "arn:aws:s3:::polystudents-ing-groupe14-tp4-q3-backup"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0088 (HIGH): Bucket does not have encryption enabled
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.


See https://avd.aquasec.com/misconfig/avd-aws-0088
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:4-12
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 ┌   "Q3BackupBucket": {
   5 │    "Properties": {
   6 │     "BucketName": "polystudents-ing-groupe14-tp4-q3-backup",
   7 │     "VersioningConfiguration": {
   8 │      "Status": "Enabled"
   9 │     }
  10 │    },
  11 │    "Type": "AWS::S3::Bucket"
  12 └   },
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0088 (HIGH): Bucket does not have encryption enabled
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.


See https://avd.aquasec.com/misconfig/avd-aws-0088
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:47-68
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  47 ┌   "Q3SourceBucket": {
  48 │    "Properties": {
  49 │     "BucketName": "polystudents-ing-groupe14-tp4-q3",
  50 │     "ReplicationConfiguration": {
  51 │      "Role": "arn:aws:iam::625730254292:role/LabRole",
  52 │      "Rules": [
  53 │       {
  54 │        "Destination": {
  55 └         "Bucket": "arn:aws:s3:::polystudents-ing-groupe14-tp4-q3-backup"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0091 (HIGH): No public access block so not blocking public acls
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.


See https://avd.aquasec.com/misconfig/avd-aws-0091
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:4-12
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 ┌   "Q3BackupBucket": {
   5 │    "Properties": {
   6 │     "BucketName": "polystudents-ing-groupe14-tp4-q3-backup",
   7 │     "VersioningConfiguration": {
   8 │      "Status": "Enabled"
   9 │     }
  10 │    },
  11 │    "Type": "AWS::S3::Bucket"
  12 └   },
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0091 (HIGH): No public access block so not blocking public acls
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.


See https://avd.aquasec.com/misconfig/avd-aws-0091
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:47-68
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  47 ┌   "Q3SourceBucket": {
  48 │    "Properties": {
  49 │     "BucketName": "polystudents-ing-groupe14-tp4-q3",
  50 │     "ReplicationConfiguration": {
  51 │      "Role": "arn:aws:iam::625730254292:role/LabRole",
  52 │      "Rules": [
  53 │       {
  54 │        "Destination": {
  55 └         "Bucket": "arn:aws:s3:::polystudents-ing-groupe14-tp4-q3-backup"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0093 (HIGH): No public access block so not restricting public buckets
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.


See https://avd.aquasec.com/misconfig/avd-aws-0093
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:4-12
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 ┌   "Q3BackupBucket": {
   5 │    "Properties": {
   6 │     "BucketName": "polystudents-ing-groupe14-tp4-q3-backup",
   7 │     "VersioningConfiguration": {
   8 │      "Status": "Enabled"
   9 │     }
  10 │    },
  11 │    "Type": "AWS::S3::Bucket"
  12 └   },
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0093 (HIGH): No public access block so not restricting public buckets
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.


See https://avd.aquasec.com/misconfig/avd-aws-0093
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:47-68
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  47 ┌   "Q3SourceBucket": {
  48 │    "Properties": {
  49 │     "BucketName": "polystudents-ing-groupe14-tp4-q3",
  50 │     "ReplicationConfiguration": {
  51 │      "Role": "arn:aws:iam::625730254292:role/LabRole",
  52 │      "Rules": [
  53 │       {
  54 │        "Destination": {
  55 └         "Bucket": "arn:aws:s3:::polystudents-ing-groupe14-tp4-q3-backup"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0132 (HIGH): Bucket does not encrypt data with a customer managed key.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.


See https://avd.aquasec.com/misconfig/avd-aws-0132
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:4-12
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   4 ┌   "Q3BackupBucket": {
   5 │    "Properties": {
   6 │     "BucketName": "polystudents-ing-groupe14-tp4-q3-backup",
   7 │     "VersioningConfiguration": {
   8 │      "Status": "Enabled"
   9 │     }
  10 │    },
  11 │    "Type": "AWS::S3::Bucket"
  12 └   },
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0132 (HIGH): Bucket does not encrypt data with a customer managed key.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.


See https://avd.aquasec.com/misconfig/avd-aws-0132
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 Q3_3.json:47-68
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  47 ┌   "Q3SourceBucket": {
  48 │    "Properties": {
  49 │     "BucketName": "polystudents-ing-groupe14-tp4-q3",
  50 │     "ReplicationConfiguration": {
  51 │      "Role": "arn:aws:iam::625730254292:role/LabRole",
  52 │      "Rules": [
  53 │       {
  54 │        "Destination": {
  55 └         "Bucket": "arn:aws:s3:::polystudents-ing-groupe14-tp4-q3-backup"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



vpc-Q3_1.yaml (cloudformation)
==============================
Tests: 40 (SUCCESSES: 36, FAILURES: 4)
Failures: 4 (MEDIUM: 0, HIGH: 4, CRITICAL: 0)

AVD-AWS-0107 (HIGH): Security group rule allows unrestricted ingress from any IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Security groups provide stateful filtering of ingress and egress network traffic to AWS
resources. It is recommended that no security group allows unrestricted ingress access to
remote server administration ports, such as SSH to port 22 and RDP to port 3389.


See https://avd.aquasec.com/misconfig/avd-aws-0107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_1.yaml:157
   via vpc-Q3_1.yaml:153-205 (polystudent14SG)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 153     polystudent14SG:
 ...   
 157 [         - CidrIp: '0.0.0.0/0'
 ...   
 205       Type: AWS::EC2::SecurityGroup
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0107 (HIGH): Security group rule allows unrestricted ingress from any IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Security groups provide stateful filtering of ingress and egress network traffic to AWS
resources. It is recommended that no security group allows unrestricted ingress access to
remote server administration ports, such as SSH to port 22 and RDP to port 3389.


See https://avd.aquasec.com/misconfig/avd-aws-0107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_1.yaml:189
   via vpc-Q3_1.yaml:153-205 (polystudent14SG)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 153     polystudent14SG:
 ...   
 189 [         - CidrIp: '0.0.0.0/0'
 ...   
 205       Type: AWS::EC2::SecurityGroup
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0164 (HIGH): Subnet associates public IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.


See https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_1.yaml:119
   via vpc-Q3_1.yaml:115-124 (PublicSubnetAZ1)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 115     PublicSubnetAZ1:
 116       Properties:
 117         AvailabilityZone: !Sub 'us-east-1a'
 118         CidrBlock: 10.0.0.0/24
 119 [       MapPublicIpOnLaunch: true
 120         Tags:
 121           - Key: Name
 122             Value: public-az1
 123         VpcId: !Ref 'VPCQ1TP4'
 124       Type: AWS::EC2::Subnet
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0164 (HIGH): Subnet associates public IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.


See https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_1.yaml:129
   via vpc-Q3_1.yaml:125-134 (PublicSubnetAZ2)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 125     PublicSubnetAZ2:
 126       Properties:
 127         AvailabilityZone: !Sub 'us-east-1b'
 128         CidrBlock: 10.0.16.0/24
 129 [       MapPublicIpOnLaunch: true
 130         Tags:
 131           - Key: Name
 132             Value: public-az2
 133         VpcId: !Ref 'VPCQ1TP4'
 134       Type: AWS::EC2::Subnet
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



vpc-Q3_2.yaml (cloudformation)
==============================
Tests: 46 (SUCCESSES: 33, FAILURES: 13)
Failures: 13 (MEDIUM: 1, HIGH: 12, CRITICAL: 0)

AVD-AWS-0028 (HIGH): Instance does not require IMDS access to require a token.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.

By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.

To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.


See https://avd.aquasec.com/misconfig/avd-aws-0028
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:113-121
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 113 ┌   PublicInstanceAZ1:
 114 │     Properties:
 115 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
 116 │       ImageId: ami-0c02fb55956c7d316
 117 │       InstanceType: t3.micro
 118 │       SecurityGroupIds:
 119 │         - !Ref 'polystudent14SG'
 120 │       SubnetId: !Ref 'PublicSubnetAZ1'
 121 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0028 (HIGH): Instance does not require IMDS access to require a token.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.

By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.

To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.


See https://avd.aquasec.com/misconfig/avd-aws-0028
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:122-130
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 122 ┌   PublicInstanceAZ2:
 123 │     Properties:
 124 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
 125 │       ImageId: ami-0c02fb55956c7d316
 126 │       InstanceType: t3.micro
 127 │       SecurityGroupIds:
 128 │         - !Ref 'polystudent14SG'
 129 │       SubnetId: !Ref 'PublicSubnetAZ2'
 130 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0028 (HIGH): Instance does not require IMDS access to require a token.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.

By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.

To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.


See https://avd.aquasec.com/misconfig/avd-aws-0028
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:75-83
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  75 ┌   PrivateInstanceAZ1:
  76 │     Properties:
  77 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
  78 │       ImageId: ami-0c02fb55956c7d316
  79 │       InstanceType: t3.micro
  80 │       SecurityGroupIds:
  81 │         - !Ref 'polystudent14SG'
  82 │       SubnetId: !Ref 'PrivateSubnetAZ1'
  83 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0028 (HIGH): Instance does not require IMDS access to require a token.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.

By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.

To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.


See https://avd.aquasec.com/misconfig/avd-aws-0028
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:84-92
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  84 ┌   PrivateInstanceAZ2:
  85 │     Properties:
  86 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
  87 │       ImageId: ami-0c02fb55956c7d316
  88 │       InstanceType: t3.micro
  89 │       SecurityGroupIds:
  90 │         - !Ref 'polystudent14SG'
  91 │       SubnetId: !Ref 'PrivateSubnetAZ2'
  92 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0107 (HIGH): Security group rule allows unrestricted ingress from any IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Security groups provide stateful filtering of ingress and egress network traffic to AWS
resources. It is recommended that no security group allows unrestricted ingress access to
remote server administration ports, such as SSH to port 22 and RDP to port 3389.


See https://avd.aquasec.com/misconfig/avd-aws-0107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:164
   via vpc-Q3_2.yaml:160-212 (polystudent14SG)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 160     polystudent14SG:
 ...   
 164 [         - CidrIp: '0.0.0.0/0'
 ...   
 212       Type: AWS::EC2::SecurityGroup
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0107 (HIGH): Security group rule allows unrestricted ingress from any IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Security groups provide stateful filtering of ingress and egress network traffic to AWS
resources. It is recommended that no security group allows unrestricted ingress access to
remote server administration ports, such as SSH to port 22 and RDP to port 3389.


See https://avd.aquasec.com/misconfig/avd-aws-0107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:196
   via vpc-Q3_2.yaml:160-212 (polystudent14SG)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 160     polystudent14SG:
 ...   
 196 [         - CidrIp: '0.0.0.0/0'
 ...   
 212       Type: AWS::EC2::SecurityGroup
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0131 (HIGH): Root block device is not encrypted.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Block devices should be encrypted to ensure sensitive data is held securely at rest.


See https://avd.aquasec.com/misconfig/avd-aws-0131
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:113-121
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 113 ┌   PublicInstanceAZ1:
 114 │     Properties:
 115 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
 116 │       ImageId: ami-0c02fb55956c7d316
 117 │       InstanceType: t3.micro
 118 │       SecurityGroupIds:
 119 │         - !Ref 'polystudent14SG'
 120 │       SubnetId: !Ref 'PublicSubnetAZ1'
 121 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0131 (HIGH): Root block device is not encrypted.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Block devices should be encrypted to ensure sensitive data is held securely at rest.


See https://avd.aquasec.com/misconfig/avd-aws-0131
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:122-130
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 122 ┌   PublicInstanceAZ2:
 123 │     Properties:
 124 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
 125 │       ImageId: ami-0c02fb55956c7d316
 126 │       InstanceType: t3.micro
 127 │       SecurityGroupIds:
 128 │         - !Ref 'polystudent14SG'
 129 │       SubnetId: !Ref 'PublicSubnetAZ2'
 130 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0131 (HIGH): Root block device is not encrypted.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Block devices should be encrypted to ensure sensitive data is held securely at rest.


See https://avd.aquasec.com/misconfig/avd-aws-0131
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:75-83
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  75 ┌   PrivateInstanceAZ1:
  76 │     Properties:
  77 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
  78 │       ImageId: ami-0c02fb55956c7d316
  79 │       InstanceType: t3.micro
  80 │       SecurityGroupIds:
  81 │         - !Ref 'polystudent14SG'
  82 │       SubnetId: !Ref 'PrivateSubnetAZ1'
  83 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0131 (HIGH): Root block device is not encrypted.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Block devices should be encrypted to ensure sensitive data is held securely at rest.


See https://avd.aquasec.com/misconfig/avd-aws-0131
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:84-92
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  84 ┌   PrivateInstanceAZ2:
  85 │     Properties:
  86 │       IamInstanceProfile: !Ref 'LabInstanceProfile'
  87 │       ImageId: ami-0c02fb55956c7d316
  88 │       InstanceType: t3.micro
  89 │       SecurityGroupIds:
  90 │         - !Ref 'polystudent14SG'
  91 │       SubnetId: !Ref 'PrivateSubnetAZ2'
  92 └     Type: AWS::EC2::Instance
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0164 (HIGH): Subnet associates public IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.


See https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:135
   via vpc-Q3_2.yaml:131-140 (PublicSubnetAZ1)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 131     PublicSubnetAZ1:
 132       Properties:
 133         AvailabilityZone: !Sub 'us-east-1a'
 134         CidrBlock: 10.0.0.0/24
 135 [       MapPublicIpOnLaunch: true
 136         Tags:
 137           - Key: Name
 138             Value: public-az1
 139         VpcId: !Ref 'VPCQ1TP4'
 140       Type: AWS::EC2::Subnet
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0164 (HIGH): Subnet associates public IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.


See https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:145
   via vpc-Q3_2.yaml:141-150 (PublicSubnetAZ2)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 141     PublicSubnetAZ2:
 142       Properties:
 143         AvailabilityZone: !Sub 'us-east-1b'
 144         CidrBlock: 10.0.16.0/24
 145 [       MapPublicIpOnLaunch: true
 146         Tags:
 147           - Key: Name
 148             Value: public-az2
 149         VpcId: !Ref 'VPCQ1TP4'
 150       Type: AWS::EC2::Subnet
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0178 (MEDIUM): VPC does not have VPC Flow Logs enabled.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.


See https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc-Q3_2.yaml:151-159
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 151 ┌   VPCQ1TP4:
 152 │     Properties:
 153 │       CidrBlock: 10.0.0.0/16
 154 │       EnableDnsHostnames: true
 155 │       EnableDnsSupport: true
 156 │       Tags:
 157 │         - Key: Name
 158 │           Value: polystudent-vpc
 159 └     Type: AWS::EC2::VPC
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



vpc_Q1.yaml (cloudformation)
============================
Tests: 40 (SUCCESSES: 35, FAILURES: 5)
Failures: 5 (MEDIUM: 1, HIGH: 4, CRITICAL: 0)

AVD-AWS-0107 (HIGH): Security group rule allows unrestricted ingress from any IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Security groups provide stateful filtering of ingress and egress network traffic to AWS
resources. It is recommended that no security group allows unrestricted ingress access to
remote server administration ports, such as SSH to port 22 and RDP to port 3389.


See https://avd.aquasec.com/misconfig/avd-aws-0107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc_Q1.yaml:148
   via vpc_Q1.yaml:144-196 (polystudent14SG)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 144     polystudent14SG:
 ...   
 148 [         - CidrIp: '0.0.0.0/0'
 ...   
 196       Type: AWS::EC2::SecurityGroup
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0107 (HIGH): Security group rule allows unrestricted ingress from any IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Security groups provide stateful filtering of ingress and egress network traffic to AWS
resources. It is recommended that no security group allows unrestricted ingress access to
remote server administration ports, such as SSH to port 22 and RDP to port 3389.


See https://avd.aquasec.com/misconfig/avd-aws-0107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc_Q1.yaml:180
   via vpc_Q1.yaml:144-196 (polystudent14SG)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 144     polystudent14SG:
 ...   
 180 [         - CidrIp: '0.0.0.0/0'
 ...   
 196       Type: AWS::EC2::SecurityGroup
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0164 (HIGH): Subnet associates public IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.


See https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc_Q1.yaml:119
   via vpc_Q1.yaml:115-124 (PublicSubnetAZ1)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 115     PublicSubnetAZ1:
 116       Properties:
 117         AvailabilityZone: !Sub 'us-east-1a'
 118         CidrBlock: 10.0.0.0/24
 119 [       MapPublicIpOnLaunch: true
 120         Tags:
 121           - Key: Name
 122             Value: public-az1
 123         VpcId: !Ref 'VPCQ1TP4'
 124       Type: AWS::EC2::Subnet
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0164 (HIGH): Subnet associates public IP address.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.


See https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc_Q1.yaml:129
   via vpc_Q1.yaml:125-134 (PublicSubnetAZ2)
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 125     PublicSubnetAZ2:
 126       Properties:
 127         AvailabilityZone: !Sub 'us-east-1b'
 128         CidrBlock: 10.0.16.0/24
 129 [       MapPublicIpOnLaunch: true
 130         Tags:
 131           - Key: Name
 132             Value: public-az2
 133         VpcId: !Ref 'VPCQ1TP4'
 134       Type: AWS::EC2::Subnet
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


AVD-AWS-0178 (MEDIUM): VPC does not have VPC Flow Logs enabled.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.


See https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 vpc_Q1.yaml:135-143
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 135 ┌   VPCQ1TP4:
 136 │     Properties:
 137 │       CidrBlock: 10.0.0.0/16
 138 │       EnableDnsHostnames: true
 139 │       EnableDnsSupport: true
 140 │       Tags:
 141 │         - Key: Name
 142 │           Value: polystudent-vpc
 143 └     Type: AWS::EC2::VPC
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


